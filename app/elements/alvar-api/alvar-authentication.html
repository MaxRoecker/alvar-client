<link rel="import" href="../../../bower_components/polymer/polymer.html" />

<link rel="import" href="../../../bower_components/iron-localstorage/iron-localstorage.html" />

<dom-module is="alvar-authentication">
  <template>
    <style>
      :host {
        display: none;
      }

    </style>

    <iron-localstorage id="storage" name="alvar-authorization"></iron-localstorage>

  </template>
  <script src="../../../bower_components/moment/min/moment.min.js" charset="utf-8"></script>
  <script>
    (function() {
      Polymer({
        is: 'alvar-authentication',

        authorize: function() {
          this.$.storage.reload();
          var authorization = this.$.storage.value;
          if (authorization) {
            var validation = moment(authorization.created).add(authorization.ttl, 's');
            if (validation.isBefore(moment())) {
              authorization = null;
            }
          }
          else {
            authorization = null;
          }
          return authorization;
        },
      });
    })();

  </script>
</dom-module>
